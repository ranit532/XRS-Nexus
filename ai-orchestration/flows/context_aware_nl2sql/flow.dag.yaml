$schema: https://azuremlschemas.azureedge.net/promptflow/latest/Flow.schema.json
environment:
  python_requirements_txt: requirements.txt
inputs:
  question:
    type: string
    default: "Show total sales by region"
  table_name:
    type: string
    default: "sales_data"
outputs:
  generated_sql:
    type: string
    reference: ${generate_sql.output}
  validation_status:
    type: string
    reference: ${validate_sql.output}

nodes:
- name: get_table_schema
  type: python
  source:
    type: code
    path: get_table_schema.py
  inputs:
    table_name: ${inputs.table_name}

- name: generate_sql
  type: python
  source:
    type: code
    path: generate_sql_wrapper.py
  inputs:
    question: ${inputs.question}
    schema: ${get_table_schema.output}

- name: validate_sql
  type: python
  source:
    type: code
    path: validate_sql.py
  inputs:
    sql_query: ${generate_sql.output}
